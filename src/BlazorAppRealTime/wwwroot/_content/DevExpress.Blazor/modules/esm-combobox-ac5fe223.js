import"./esm-chunk-eaca7b99.js";import{H as e,x as t,t as o,aa as n,D as s}from"./esm-chunk-dac9ea79.js";import{D as r,R as a}from"./esm-chunk-b9f5fab8.js";import{T as i}from"./esm-chunk-e2d38309.js";import{K as u}from"./esm-chunk-6d4715b2.js";import"./esm-chunk-95f069f9.js";import{ScrollToFocusedItem as c,GetParametersForVirtualScrollingRequest as m}from"./esm-grid-2647aa6c.js";import"./esm-popup-utils-d6369604.js";import"./esm-focus-utils-1e722fd2.js";import"./esm-chunk-e05effe2.js";import"./esm-dragAndDropUnit-9fa8c743.js";import{T as d}from"./esm-chunk-40d95150.js";import{GetDropDownElement as l,OnOutsideClick as f,IsDropDownVisible as p}from"./esm-dropdowns-75ef2813.js";import{K as y,a as k}from"./esm-chunk-511b3c8e.js";var v;function C(e){var t=l(e);c(t)}function h(t){t=e(t),document.activeElement===t&&w(t)}function b(e,t){e.dataset.timerId&&(clearTimeout(e.dataset.timerId),delete e.dataset.timerId),t||window.setTimeout((function(){b(e,!0)}),100)}function w(e){e&&e.dataset.focusedClass&&(e.className=e.dataset.focusedClass)}function g(e,t){return t&&y(e),function(e){return j(e)||e.keyCode==u.Enter}(e)&&(e.stopPropagation(),e.preventDefault()),!1}function D(e,t,o,n,s){var r=!1;if(n&&(r=r||k(e)),r=r||function(e){var t=e.altKey&&(e.keyCode==u.Down||e.keyCode==u.Up),o=j(e),n=e.keyCode==u.Esc||e.keyCode==u.Enter;return t||o||n}(e)){var a=e.target.value;if(o&&s){let n=o.querySelector(".dxgvCSD");n&&(o=n);var i=m(o,!1);t.invokeMethodAsync("OnComboBoxListBoxKeyUp",a,e.keyCode,e.altKey,e.ctrlKey,i.requestScrollState.itemHeight,i.requestScrollState.scrollTop,i.requestScrollState.scrollHeight)}else t.invokeMethodAsync("OnComboBoxKeyUp",a,e.keyCode,e.altKey,e.ctrlKey)}}function j(e){return e.keyCode===u.Down||e.keyCode===u.Up||e.keyCode===u.PageUp||e.keyCode===u.PageDown||e.ctrlKey&&(e.keyCode===u.Home||e.keyCode===u.End)}function E(e,t,o){if(t){var n=(new Date).getTime();t.dataset.lastLostFocusTime&&n-t.dataset.lastLostFocusTime<300&&!o||(t.dataset.lastLostFocusTime=(new Date).getTime(),e.invokeMethodAsync("OnComboBoxLostFocus",t.value))}}function T(u,c){var m=e(c.mainElement);if(m){r(m);var y=c.filteringEnabled,k=e(c.inputElement),C=l(m),h=C,j=function(e){return g(e,y)},T=function(e){return D(e,u,h,y,c.virtualScrollingEnabled)},S=function(e){return function(e,t){w(e.target)}(e)},I=function(e){return function(e,t){var o=e.target;b(o,!0),o.dataset.timerId=window.setTimeout((function(){if(delete o.dataset.timerId,function(e){e&&e.dataset.bluredClass&&(e.className=e.dataset.bluredClass)}(o),document.activeElement!==o)try{E(t,o)}catch(e){}}),200)}(e,u)},K=function(e){return b(k)},x=function(e){return f(e,m,(function(){n(m)||r(m);var e=document.activeElement===k,t=k.dataset.timerId>0,o=C&&p(C);b(k),(e||t||o)&&E(u,k,!0)}))};t(k,"keydown",j),t(k,"keyup",T),t(k,"focus",S),t(k,"blur",I),t(m,"mousedown",K),t(document,i.touchMouseDownEventName,x),a(m,(function(){s(k,"keydown",j),s(k,"keyup",T),s(k,"focus",S),s(k,"blur",I),s(m,"mousedown",K),s(document,i.touchMouseDownEventName,x)}));var P=o(k,"card");return C&&P&&(v&&v.Dispose(),v=d(m,P,(function(e){C.style.visibility=e?"visible":"hidden"}))),Promise.resolve("ok")}}function S(t){if(t=e(t))return r(t),v&&v.Dispose(),Promise.resolve("ok")}const I={Init:T,Dispose:S,PrepareInputIfFocused:h,ScrollToSelectedItem:C};export default I;export{S as Dispose,T as Init,h as PrepareInputIfFocused,C as ScrollToSelectedItem};
