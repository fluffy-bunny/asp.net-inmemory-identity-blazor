import"./esm-chunk-eaca7b99.js";import{H as e,W as t,x as o,t as n,aj as i,A as r,aa as s,D as a,V as c}from"./esm-chunk-dac9ea79.js";import{D as u,R as l}from"./esm-chunk-b9f5fab8.js";import{T as d}from"./esm-chunk-e2d38309.js";import{K as f}from"./esm-chunk-6d4715b2.js";import"./esm-chunk-95f069f9.js";import{ScrollToFocusedItem as m}from"./esm-grid-2647aa6c.js";import{show as v}from"./esm-popup-utils-d6369604.js";import{InitFocusHidingEvents as p}from"./esm-focus-utils-1e722fd2.js";import"./esm-chunk-e05effe2.js";import"./esm-dragAndDropUnit-9fa8c743.js";import{P as h,a as g}from"./esm-chunk-40d95150.js";const w={Popup:0,Modal:1},b=1,y=2,E=new WeakMap;var x;function D(t){let o=(t=e(t)).querySelector("div.dxbs-dm.dropdown-menu");return o||(o=t.querySelector("div.dxgvCSD.dxbs-grid-vsd")),o}function L(t,o,n,i){return new Promise((function(n,r){var s=D(t);return(s=e(s))?(0==i&&(s.style.minWidth=t.offsetWidth+"px"),2==i&&(s.style.width=t.offsetWidth+"px",s.style.overflowX="hidden"),C(t,s,o),m(s),n()):n()}))}function C(e,o,n,i){E.has(e)&&(E.get(e).disconnect(),E.delete(e));let r=o.offsetParent;if(!r)return t((function(){o.style.visibility=""})),void 0;let s,a=r.getBoundingClientRect(),c=e.getBoundingClientRect(),u=c.top-a.top,l=a.bottom-c.bottom,d=window.getComputedStyle(o),f=o.offsetHeight+Math.max(parseFloat(d.marginTop),0)+Math.max(parseFloat(d.marginBottom),0)+8;switch(n){case y:s=!0,a.top+(u-f)<=0&&a.top+u+e.offsetHeight+f+pageYOffset<=Math.max(document.body.scrollHeight,window.innerHeight)&&(s=!1);break;case b:default:s=!1,a.bottom-(l-f)>=window.innerHeight&&a.top+u-f+pageYOffset>=0&&(s=!0)}t((function(){x&&x.Dispose(),x=s?h(o).LeftBottomCorner.AnchorTo(g(e).LeftTopCorner):h(o).LeftTopCorner.AnchorTo(g(e).LeftBottomCorner),o.style.visibility=""}))}const M=[{value:0,text:""},{value:1,text:"above"},{value:2,text:"below"},{value:4,text:"top-sides"},{value:8,text:"bottom-sides"},{value:16,text:"outside-left"},{value:32,text:"outside-right"},{value:64,text:"left-sides"},{value:128,text:"right-sides"}];function T(e,t,o){for(var n=e.target;n;){if(n===t)return!1;n=n.parentElement}o&&o()}function k(e){return"hidden"!==e.style.visibility||e.classList.contains("visually-hidden")}const H="a[href], input:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex='-1'])";function S(e,t){if(n(e.srcElement,"modal-header"))return!0;var o=n(e.srcElement,"column-chooser-elements-container"),i=n(o,"modal-body");if(!o||!i)return!1;if(i.clientHeight>=o.clientHeight)return!0;var r=e.touches[0].pageY-t.touches[0].pageY,s=function(e){return e.getBoundingClientRect().top},a=o.querySelector(".column-chooser-element-container");if(a&&s(a)===s(i)&&r>=0&&e.cancelable)return!0;var c=function(e){return Math.round(e.getBoundingClientRect().bottom)},u=o.querySelector(".column-chooser-element-container:last-child");return!!(u&&c(u)===c(i)&&r<=0&&e.cancelable)||void 0}function j(e,t,o){if(o===w.Modal){var i=e.getBoundingClientRect(),r=t.getBoundingClientRect(),s=n(e,"dxbs-gridview"),a=s&&s.querySelector("thead");if(a){var c=a.getBoundingClientRect(),u=(c||i).bottom;return u>.5*t.clientHeight?u-i.top<.5*t.clientHeight?u-r.top-.5*t.clientHeight:i.top-r.top-2:void 0}}}function N(e){e.classList.add("dx-blazor-dialog-notification-shown"),setTimeout(()=>{e.classList.remove("dx-blazor-dialog-notification-shown")},3e3)}const P={Init:function(t,n,i,r){if(t=e(t),n=e(n),i=e(i),t){if(u(t),i){var c=function(e){return T(e,t,(function(){s(t)||u(t);var e=document.activeElement===n,o=i&&k(i);(e||o)&&r.invokeMethodAsync("OnDropDownLostFocus",n.value)}))};o(document,d.touchMouseDownEventName,c),l(t,(function(){a(document,d.touchMouseDownEventName,c)}))}return Promise.resolve("ok")}},Dispose:function(t){return(t=e(t))&&u(t),x&&x.Dispose(),Promise.resolve("ok")},ShowAdaptiveDropdown:function(o,s,a,u,l){o=e(o);var m=n(o,a);if(m){m.querySelector("."+u);var h=document.documentElement,g=document.documentElement.style.overflow,b=document.body.style.overflow,y=document.body.scroll,E=s.dialogType,x=s.alignment,D=E===w.Modal;E===w.Popup&&(0==x?C(m,o,s.dropDownDirection):v(o,m,function(e){var t="";return M.forEach(o=>{0!=(o.value&e)&&(t&&(t+=" "),t+=o.text)}),t}(x)));var L=!1;return h.addEventListener(d.touchMouseDownEventName,T),o.addEventListener("keydown",(function(e){e.keyCode===f.Esc&&N()})),o.addEventListener("focusout",(function(e){var t,n,i,r;L||(null===e.relatedTarget||o.contains(e.relatedTarget)?null===e.relatedTarget&&h.addEventListener("focusin",k):void((t=o.compareDocumentPosition(e.relatedTarget))&Node.DOCUMENT_POSITION_PRECEDING?(i=o,r=i.querySelectorAll(H),n=r[r.length-1],void(n&&n.focus())):t&Node.DOCUMENT_POSITION_FOLLOWING&&O()))})),function(e,t,o,n){e&&t.addEventListener("touchmove",e=>{e.srcElement===t&&e.preventDefault()});if(n===w.Modal){var i=null;o.addEventListener("touchstart",e=>{i=e}),o.addEventListener("touchmove",e=>{S(e,i)&&e.preventDefault(),i=e})}}(D,o,m,E),i(o).then(()=>{P(),o=null}),R(E,!0),E===w.Popup?t((function(){o&&(s.showFocus||(r(o,"dxbs-focus-hidden"),p(o)),O())})):(window.addEventListener("resize",B),B()),Promise.resolve()}function T(e){(!o.contains(e.srcElement)||E===w.Modal&&o===e.srcElement)&&N()}function k(e){h.removeEventListener("focusin",k),null===e.relatedTarget&&e.target&&o&&o.contains(e.target)&&e.target.focus()}function N(){L||(L=!0,setTimeout((function(){P(),l.invokeMethodAsync("CloseDialog")}),200))}function P(){h.removeEventListener(d.touchMouseDownEventName,T),window.removeEventListener("resize",B),R(E,!1)}function O(){var e=o.querySelector(H);e&&e.focus()}function B(){if(n(o,"modal-dialog-owner")){var e=o.firstElementChild.classList,t=j(m,h,E),i=h.clientHeight>h.clientWidth?"topVertical":"topHorizontal";c((function(){e.contains("topVertical")||e.contains("topHorizontal")?e.remove("transition"):e.add("transition"),t&&(h.scrollTop=t),e.remove("topVertical","topHorizontal"),e.add(i)}))}}function R(e,t){var o,n,i;e===w.Modal&&(t?(o="hidden",n="hidden",i="no"):(o=g,n=b,i=y),document.documentElement.style.overflow=o,document.body.style.overflow=n,document.body.scroll=i)}},UpdateGridDropDown:L,ShowNotification:N};export default P;export{w as DialogType,D as GetDropDownElement,k as IsDropDownVisible,T as OnOutsideClick,j as ScrollDropDown,C as SetPositionOfDropDown,S as ShouldPreventTouchMove,N as ShowNotification,L as UpdateGridDropDown};
