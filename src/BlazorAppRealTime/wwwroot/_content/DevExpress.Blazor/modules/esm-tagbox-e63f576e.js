import"./esm-chunk-eaca7b99.js";import{I as e,H as t,t as o,x as n,aa as a,D as r}from"./esm-chunk-dac9ea79.js";import{D as s,R as u}from"./esm-chunk-b9f5fab8.js";import{T as i}from"./esm-chunk-e2d38309.js";import{K as c}from"./esm-chunk-6d4715b2.js";import"./esm-chunk-95f069f9.js";import{ScrollToFocusedItem as d,GetParametersForVirtualScrollingRequest as m}from"./esm-grid-2647aa6c.js";import"./esm-popup-utils-d6369604.js";import"./esm-focus-utils-1e722fd2.js";import"./esm-chunk-e05effe2.js";import"./esm-dragAndDropUnit-9fa8c743.js";import"./esm-chunk-40d95150.js";import{GetDropDownElement as l,OnOutsideClick as f,IsDropDownVisible as p}from"./esm-dropdowns-75ef2813.js";import{K as v,a as k}from"./esm-chunk-511b3c8e.js";function y(e){var t=l(e);d(t)}function g(t,o,n){e(t,"value",o),h(t),n&&function(e){e&&e.select()}(t)}function h(e){e.previousSibling.innerText=""==e.value&&e.placeholder?e.placeholder:e.value}function C(e){e=t(e),document.activeElement===e&&E(e)}function w(e,t){var n=e.target;T(n,!0),function(e){if(e){var t=o(e,"form-control");t.dataset.bluredClass&&(t.className=t.dataset.bluredClass)}}(n),n.dataset.timerId=window.setTimeout((function(){if(delete n.dataset.timerId,document.activeElement!==n)try{D(t,n)}catch(e){}}),200)}function T(e,t){e.dataset.timerId&&(clearTimeout(e.dataset.timerId),delete e.dataset.timerId),t||window.setTimeout((function(){T(e,!0)}),100)}function E(e){if(e){var t=o(e,"form-control");t.dataset.focusedClass&&(t.className=t.dataset.focusedClass)}}function j(e,t){return t&&v(e),function(e){return b(e)||e.keyCode==c.Enter}(e)&&(e.stopPropagation(),e.preventDefault()),!1}function I(e,t,o,n,a){var r=!1;if(n&&(r=r||k(e)),r=r||function(e){var t=e.altKey&&(e.keyCode==c.Down||e.keyCode==c.Up),o=b(e),n=e.keyCode==c.Esc||e.keyCode==c.Enter,a=function(e){var t=0==e.target.value.length;return e.keyCode==c.Backspace&&t}(e);return t||o||n||a}(e)){var s=e.target.value,u=""!=e.target.dataset.previousValue;if(o&&a){var i=m(o,!1);t.invokeMethodAsync("OnTagBoxListBoxKeyUp",s,e.keyCode,e.altKey,e.ctrlKey,i.requestScrollState.itemHeight,i.requestScrollState.scrollTop,i.requestScrollState.scrollHeight,u)}else t.invokeMethodAsync("OnTagBoxKeyUp",s,e.keyCode,e.altKey,e.ctrlKey,u)}}function b(e){return e.keyCode===c.Down||e.keyCode===c.Up||e.keyCode===c.PageUp||e.keyCode===c.PageDown||e.ctrlKey&&(e.keyCode===c.Home||e.keyCode===c.End)}function D(e,t,o){if(t){var n=(new Date).getTime();t.dataset.lastLostFocusTime&&n-t.dataset.lastLostFocusTime<300&&!o||(t.dataset.lastLostFocusTime=(new Date).getTime(),document.activeElement!=t&&(t.value=""),e.invokeMethodAsync("OnTagBoxLostFocus",t.value))}}function K(e,o){var c=t(o.mainElement);if(c){s(c);var d=t(o.inputElement),m=l(c),v=function(e){return j(e,o.filteringEnabled)},k=function(t){return I(t,e,m,o.filteringEnabled,o.virtualScrollingEnabled)},y=function(e){return function(e,t){E(e.target)}(e)},g=function(t){return w(t,e)},C=function(e){return h(e.target)},b=function(e){return T(d)},K=function(t){return f(t,c,(function(){a(c)||s(c);var t=document.activeElement===d,o=d.dataset.timerId>0,n=m&&p(m);T(d),(t||o||n)&&D(e,d,!0)}))};return n(d,"keydown",v),n(d,"keyup",k),n(d,"focus",y),n(d,"blur",g),n(d,"input",C),n(c,"mousedown",b),n(document,i.touchMouseDownEventName,K),u(c,(function(){r(d,"keydown",v),r(d,"keyup",k),r(d,"focus",y),r(d,"blur",g),r(d,"input",C),r(c,"mousedown",b),r(document,i.touchMouseDownEventName,K)})),h(d),Promise.resolve("ok")}}function S(e){if(e=t(e))return s(e),Promise.resolve("ok")}const F={Init:K,Dispose:S,PrepareInputIfFocused:C,ScrollToFocusedItem:y,FitInputWidth:h,ForceInputValue:g};export default F;export{S as Dispose,h as FitInputWidth,g as ForceInputValue,K as Init,C as PrepareInputIfFocused,y as ScrollToFocusedItem};
